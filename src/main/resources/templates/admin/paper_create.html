<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,minimum-scale=1.0,user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="ThemeBucket">
    <link rel="shortcut icon"  type="image/png">
    <title>试卷创编</title>

    <link th:href="@{/css/bootstrap.min.css}" rel="stylesheet">
    <!--dashboard calendar-->
    <link href="/css/clndr.css" rel="stylesheet">

    <!--pickers css-->
    <link rel="stylesheet" type="text/css" href="/js/bootstrap-datepicker/css/datepicker-custom.css" />
    <link rel="stylesheet" type="text/css" href="/js/bootstrap-timepicker/css/timepicker.css" />
    <link rel="stylesheet" type="text/css" href="/js/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="/js/bootstrap-daterangepicker/daterangepicker-bs3.css" />
    <link rel="stylesheet" type="text/css" href="/js/bootstrap-datetimepicker/css/datetimepicker-custom.css" />

    <!--common-->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/jquery.stepy.css" rel="stylesheet">
    <link href="/css/style-responsive.css" rel="stylesheet">
    <script type="text/css">
        .form-control[disabled], .form-control[readonly], fieldset[disabled] .form-control {
            cursor: not-allowed;
            background-color: #fff;
            opacity: 1;
            text-align: center;
        }
    </script>
</head>

<body class="sticky-header">

<!--左侧开始-->
<div th:replace="~{/admin/commons/common :: commonleft}"></div>
<!--左侧结束-->

<!--主页面开始-->
<div class="main-content" >
    <!--头部开始-->
    <div th:replace="~{/admin/commons/common :: commonheader}"></div>
    <!--头部结束-->


    <!--当前位置介绍开始-->
    <div class="page-heading">
        <h3>
            试卷创编
        </h3>
        <ul class="breadcrumb">
            <li>
                <a href="#">卷库管理</a>
            </li>
            <li class="active"> 试卷创编 </li>
        </ul>
    </div>
    <!-- 当前位置介绍结束-->


    <!--    body wrapper start-->
    <div class="wrapper">
        <div class="col-md-12">
            <section class="panel">
                <header class="panel-heading">
                    随机创建......
                    <span class="tools pull-right">
                                <a class="fa fa-chevron-down" href="javascript:;"></a>
                                <a class="fa fa-times" href="javascript:;"></a>
                    </span>
                </header>
                <div class="panel-body">
                    <form class="form-horizontal" id="for" th:action="@{/admin/createPaperOpt}">

                        <div class="form-group ">
                            <label class="control-label col-md-1" style="float: left;"> 试卷名</label>
                            <div class="col-md-4">
                                <input type="text" class="form-control" name="paperName" id="paperName">
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-1">单选题数</label>
                            <div class="col-md-4">
                                <div id="single">
                                    <div class="input-group input-small">
<!--                                        设置只能输入数字-->
                                        <input type="text" class="spinner-input form-control" maxlength="3" value="0" name="singleSelectNumber" id="singleSelectNumber"
                                               onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                        <div class="spinner-buttons input-group-btn btn-group-vertical">
                                            <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incNumber($('#singleSelectNumber'))">
                                                <i class="fa fa-angle-up"></i>
                                            </button>
                                            <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disNumber($('#singleSelectNumber'))">
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-group">
                            <label class="control-label col-md-1">多选题数</label>
                            <div class="col-md-4">
                                <div id="moreSelectNum">
                                    <div class="input-group input-small">
                                        <input type="text" class="spinner-input form-control" maxlength="3" value="0" name="moreNumber" id="moreNumber" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                        <div class="spinner-buttons input-group-btn btn-group-vertical">
                                            <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incNumber($('#moreNumber'))">
                                                <i class="fa fa-angle-up"></i>
                                            </button>
                                            <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disNumber($('#moreNumber'))">
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-1">判断题数</label>
                            <div class="col-md-4">
                                <div >
                                    <div class="input-group input-small">
                                        <input type="text" class="spinner-input form-control" maxlength="3" value="0" name="judgeNumber" id="judgeNumber" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')" >
                                        <div class="spinner-buttons input-group-btn btn-group-vertical">
                                            <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incNumber($('#judgeNumber'))">
                                                <i class="fa fa-angle-up"></i>
                                            </button>
                                            <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disNumber($('#judgeNumber'))">
                                                <i class="fa fa-angle-down"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

<!--                            <label class="control-label col-md-1">判断题分值</label>-->
<!--                            <div class="col-md-4">-->
<!--                                <div id="judgeScoreD">-->
<!--                                    <div class="input-group input-small">-->
<!--                                        <input type="text" class="spinner-input form-control" maxlength="3" value="1" name="judgeScore" id="judgeScore" onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">-->
<!--                                        <div class="spinner-buttons input-group-btn btn-group-vertical">-->
<!--                                            <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incScore($('#judgeScore'))">-->
<!--                                                <i class="fa fa-angle-up"></i>-->
<!--                                            </button>-->
<!--                                            <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disScore($('#judgeScore'))">-->
<!--                                                <i class="fa fa-angle-down"></i>-->
<!--                                            </button>-->
<!--                                        </div>-->
<!--                                    </div>-->
<!--                                </div>-->
<!--                            </div>-->
                        </div>


                        <div class="form-group">
                            <label class="control-label col-md-1"> 开始时间</label>
                            <div class="col-md-4">
                                <div class="input-group date form_datetime-component">
                                    <input type="text" class="form-control" readonly="" size="16" name="startTime" id="startTime">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary date-set"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-1">结束时间</label>
                            <div class="col-md-4">
                                <div class="input-group date form_datetime-component">
                                    <input type="text" class="form-control" readonly="" size="16" name="endTime" id="endTime">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary date-set"><i class="fa fa-calendar"></i></button>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12" style="float:right">
                            <a target="_blank" href="#">Tips：随机从题库中抽取题目进行创建，且题目项不会重复，注意题目数最多100题。</a>
                            <a class="btn btn-success btn-sm " style="float:right" onclick="createPaper()"><i class="fa fa-check"></i> 开始创建 </a>
                        </div>

                        <a href="#myModal1" data-toggle="modal" class="btn btn-warning hidden" id="tip1">
                            提示按钮
                        </a>
                    </form>
                    <!--                        弹出框开始-->
                    <div class="col-md-12 ">
                        <a href="#myModal2" data-toggle="modal" class="btn btn-warning hidden" id="tip2">
                            提示按钮
                        </a>
                        <div aria-hidden="true" aria-labelledby="myModalLabel" role="dialog" tabindex="-1" id="myModal2" class="modal fade" style="display: none;">
                            <div class="modal-dialog">
                                <div class="modal-content">
                                    <div class="modal-header" id="modelColor" style="background:#65CEA7">
                                        <button aria-hidden="true" data-dismiss="modal" class="close" type="button">×</button>
                                        <h4 class="modal-title">提示</h4>
                                    </div>
                                    <div class="modal-body">
                                        <p id="paperCreateTips"></p>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-default hidden" data-dismiss="modal" onclick="toLook()" id="toLook">去查看</button>
                                        <button type="button" class="btn btn-default hidden" data-dismiss="modal" id="cancel">取消</button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
<!--                    弹出框结束-->
<!--                    隐藏域-->
                    <input id="successPaperName" class="hidden">
                </div>
            </section>
        </div>
<!--        自定义创建开始-->
            <div class="col-md-12">
                <section class="panel">
                    <header class="panel-heading">
                        自定义创建......
                        <span class="tools pull-right">
                                <a class="fa fa-chevron-down" href="javascript:;"></a>
                                <a class="fa fa-times" href="javascript:;"></a>
                        </span>
                    </header>
                    <div class="panel-body">
                <h4 class="fw-title">按步骤完成即可创建试卷</h4>
                <div class="box-widget">
                    <div class="widget-head clearfix">
                        <div id="top_tabby" class="block-tabby pull-left">
                        </div>
                    </div>
                    <div class="widget-container">
                        <div class="widget-block">
                            <div class="widget-content box-padding">
                                <form id="stepy_form" class=" form-horizontal left-align form-well">
                                    <fieldset title="Step 1">
                                        <legend>初始化</legend>
                                        <div class="form-group ">
                                            <label class="control-label col-md-1" style="float: left;"> 试卷名</label>
                                            <div class="col-md-4">
                                                <input type="text" class="form-control" name="paperName1" id="paperName1">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label col-md-1"> 开始时间</label>
                                            <div class="col-md-4">
                                                <div class="input-group date form_datetime-component">
                                                    <input type="text" class="form-control" readonly="" size="16" name="startTime1" id="startTime1">
                                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary date-set"><i class="fa fa-calendar"></i></button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="control-label col-md-1">结束时间</label>
                                            <div class="col-md-4">
                                                <div class="input-group date form_datetime-component">
                                                    <input type="text" class="form-control" readonly="" size="16" name="endTime1" id="endTime1">
                                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn-primary date-set"><i class="fa fa-calendar"></i></button>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <fieldset title="Step 2">
                                        <legend>单选题选择</legend>

                                            <div class="form-group s" th:each="type0 :${typeList}">
                                                <div class="control-label col-md-5">
                                                    <label class="control-label col-md-2">单选数</label><div class="col-md-3">
                                                    <div id="singleChoice">
                                                        <div class="input-group input-small" >
                                                            <input type="text" class="spinner-input form-control valid" maxlength="3" value="0" th:name="'singNumber'+${type0.getQPool()}" th:id="'singId'+${type0.getQPool()}"
                                                                   onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                                            <div class="spinner-buttons input-group-btn btn-group-vertical">
                                                                <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incNumber1(this.parentNode.parentNode.children[0])">
                                                                    <i class="fa fa-angle-up"></i>
                                                                </button>
                                                                <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disNumber1(this.parentNode.parentNode.children[0])">
                                                                    <i class="fa fa-angle-down"></i>
                                                                </button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                    <label  class=" control-label col-md-2">分类</label>
                                                    <div class="btn-group col-md-3">
                                                        <button id="questionTypeButton1" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" type="button">题目类型 <span class="caret"></span></button>
                                                        <ul role="menu" class="dropdown-menu" style="text-align: left">
                                                            <li  th:each="type :${typeList}" >
                                                                <a th:value="${type.getQPool()}" th:text="${type.getQType()}"
                                                                   th:onclick="questionPool1([[${type.getQPool()}]],[[${type.getQType()}]],
                                                                   this.parentNode.parentNode.parentNode.children[2],this.parentNode.parentNode.parentNode.children[0])"
                                                                   style="width: 100%" href="javascript:void(0);">
                                                                </a></li>
                                                        </ul>
                                                        <input class="hidden" th:id="'singPool'+${type0.getQPool()}" th:name="'singPool'+${type0.getQPool()}" value="0">
                                                    </div>
                                                </div>
                                            </div>

                                        <div class="form-group">
                                            <div class="col-md-5">
                                                <button type="button" class="btn btn-sm btn-success" onclick="addLine()"><i class="fa fa-plus"></i>添加选项</button>
                                                <button type="button" class="btn btn-sm btn-danger" onclick="reduceLine()"><i class="fa fa-minus"></i>减少选项</button>
                                            </div>
                                        </div>

                                    </fieldset>







                                    <fieldset title="Step 3">
                                        <legend>多选题选择</legend>

                                        <div class="form-group m" th:each="type1 :${typeList}">
                                            <div class="control-label col-md-5">
                                                <label class="control-label col-md-2">多选数</label><div class="col-md-3">
                                                <div id="moreChoice">
                                                    <div class="input-group input-small" >
                                                        <input type="text" class="spinner-input form-control valid" maxlength="3" value="0" th:name="'moreNumber'+${type1.getQPool()}" th:id="'moreId'+${type1.getQPool()}"
                                                               onkeyup="this.value=this.value.replace(/\D/g,'')" onafterpaste="this.value=this.value.replace(/\D/g,'')">
                                                        <div class="spinner-buttons input-group-btn btn-group-vertical">
                                                            <button type="button" class="btn spinner-up btn-xs btn-default" onclick="incNumber1(this.parentNode.parentNode.children[0])">
                                                                <i class="fa fa-angle-up"></i>
                                                            </button>
                                                            <button type="button" class="btn spinner-down btn-xs btn-default" onclick="disNumber1(this.parentNode.parentNode.children[0])">
                                                                <i class="fa fa-angle-down"></i>
                                                            </button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                                <label  class=" control-label col-md-2">分类</label>
                                                <div class="btn-group col-md-3">
                                                    <button id="questionTypeButton2" class="btn btn-warning dropdown-toggle" data-toggle="dropdown" type="button">题目类型 <span class="caret"></span></button>
                                                    <ul role="menu" class="dropdown-menu" style="text-align: left">
                                                        <li  th:each="type :${typeList}" >
                                                            <a th:value="${type.getQPool()}" th:text="${type.getQType()}"
                                                               th:onclick="questionPool1([[${type.getQPool()}]],[[${type.getQType()}]],
                                                                   this.parentNode.parentNode.parentNode.children[2],this.parentNode.parentNode.parentNode.children[0])"
                                                               style="width: 100%" href="javascript:void(0);">
                                                            </a></li>
                                                    </ul>
                                                    <input class="hidden" th:id="'morePool'+${type1.getQPool()}" th:name="'morePool'+${type1.getQPool()}" value="0" >
                                                </div>
                                            </div>
                                        </div>

                                        <div class="form-group">
                                            <div class="col-md-5">
                                                <button type="button" class="btn btn-sm btn-success" onclick="addLine2()"><i class="fa fa-plus"></i>添加选项</button>
                                                <button type="button" class="btn btn-sm btn-danger" onclick="reduceLine2()"><i class="fa fa-minus"></i>减少选项</button>
                                            </div>
                                        </div>

                                    </fieldset>
                                    <fieldset title="Step 4">
                                        <legend>完成创建</legend>
                                        <div class="form-group">
                                            <label class="col-md-2 col-sm-2 control-label">Text Input</label>
                                            <div class="col-md-6 col-sm-6">
                                                <input type="text" placeholder="Text Input" class="form-control">
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-md-2 col-sm-2 control-label">Checkbox</label>
                                            <div class="col-md-6 col-sm-6">
                                                <label class="checkbox">
                                                    <input type="checkbox" value="">
                                                    Option one is this and that—be sure to include why it's great </label>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <label class="col-md-2 col-sm-2 control-label">Radio</label>
                                            <div class="col-md-6 col-sm-6">
                                                <label class="radio">
                                                    <input type="radio" name="optionsRadios" value="option1" checked>
                                                    Option one is this and that—be sure to include why it's great </label>
                                            </div>
                                        </div>
                                    </fieldset>
                                    <button type="button" onclick="diySubmit()"  class="finish btn btn-info btn-extend"> 完成!</button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                    </div>
                </section>
        </div>
    </div>
    <!--        自定义创建结束-->

    <!--    body wrapper end-->

    <!--footer section start-->
    <footer>
        2022 &copy;<a href="https://www.pdsu.edu.cn/" target="_blank">平顶山学院软件应用双创实验室提供技术支持</a>
    </footer>
    <!--footer section end-->


</div>
<!--主页面结束-->



<!-- Placed js at the end of the document so the pages load faster -->
<script src="/js/jquery-1.10.2.min.js"></script>
<script src="/js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/js/jquery.validate.min.js"></script>
<script src="/js/jquery.stepy.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/modernizr.min.js"></script>
<script src="/js/jquery.nicescroll.js"></script>

<!--pickers plugins-->
<script type="text/javascript" src="/js/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="/js/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
<script type="text/javascript" src="/js/bootstrap-daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="/js/bootstrap-daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="/js/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript" src="/js/bootstrap-timepicker/js/bootstrap-timepicker.js"></script>
<!--pickers initialization-->
<script src="/js/pickers-init.js"></script>

<!--spinner-->
<script type="text/javascript" src="/js/fuelux/js/spinner.min.js"></script>
<script src="/js/spinner-init.js"></script>


<!--表单校验-->
<script type="text/javascript" src="js/jquery.validate.min.js"></script>
<script src="js/validation-init.js"></script>

<!--common scripts for all pages-->
<script src="/js/scripts.js"></script>
<script type="text/javascript">



    /*=====STEPY WIZARD====*/
    $(function() {
        $('#default').stepy({
            backLabel: 'Previous',
            block: true,
            nextLabel: 'Next',
            titleClick: true,
            titleTarget: '.stepy-tab'
        });
    });
    /*=====STEPY WIZARD WITH VALIDATION====*/
    $(function() {
        $('#stepy_form').stepy({
            backLabel: '上一步',
            nextLabel: '下一步',
            errorImage: true,
            block: true,
            description: true,
            legend: false,
            titleClick: true,
            titleTarget: '#top_tabby',
            validate: true
        });
        $('#stepy_form').validate({
            errorPlacement: function(error, element) {
                $('#stepy_form div.stepy-error').append(error);
            },
            rules: {
                'paperName': 'required',
                'startTime': 'required',
                'endTime': 'required'
            },
            messages: {
                'paperName': {
                    required: '试卷名未填写!'
                },
                'startTime': {
                    required: '考试开始时间未填写!'
                },
                'endTime': {
                    required: '考试结束时间未填写!'
                }
            }
        });
    });
    function createPaper() {
        var paperName = $('#paperName').val()
        var singleSelectNumber = $('#singleSelectNumber').val()
        var moreSelectNumber = $('#moreNumber').val()
        var judgeNumber = $('#judgeNumber').val()
        var startTime0 = $('#startTime').val()
        var endTime0 = $('#endTime').val()
        startTime = dateFormat(startTime0)
        endTime = dateFormat(endTime0)
        alert(singleSelectNumber)
        alert(moreSelectNumber)
        var sum = parseInt(singleSelectNumber) + parseInt(moreSelectNumber)
        if(parseInt(singleSelectNumber) < 1 || parseInt(moreSelectNumber) < 1){
            $('#toLook').addClass('hidden')
            $('#cancel').text('确定').removeClass('hidden')
            if(parseInt(singleSelectNumber) < 1){
                $('#modelColor').attr('style','background : #bb1f1f')
                $('#paperCreateTips').text('单选题数小于1，无法创建！')
                $('#tip2').click()
            }
            else if(parseInt(moreSelectNumber) < 1){
                $('#modelColor').attr('style','background : #bb1f1f')
                $('#paperCreateTips').text('多选题数小于1，无法创建！')
                $('#tip2').click()
            }
            else {
                $('#modelColor').attr('style','background : #bb1f1f')
                $('#paperCreateTips').text('题数过少，无法创建！')
                $('#tip2').click()
            }
        }
        else if(sum > 100){
            $('#cancel').text('确定').removeClass('hidden')
            $('#modelColor').attr('style','background : #bb1f1f')
            $('#paperCreateTips').text('试题数大于100，无法创建！')
            $('#tip2').click()
        }
        else{
            $.ajax({
                //请求路径
                url: "/admin/createPaperOperate",
                //请求类型
                type: "POST",
                //data表示发送的数据
                data: JSON.stringify({
                    paperName:paperName,
                    singleSelectNumber:singleSelectNumber,
                    moreSelectNumber:moreSelectNumber,
                    judgeNumber:judgeNumber,
                    startTime:startTime,
                    endTime:endTime
                }), //定义发送请求的数据格式为JSON字符串
                contentType: "application/json;charset=utf-8",
                //定义回调响应的数据格式为JSON字符串，该属性可以省略
                dataType: "json",
                //成功响应的结果
                success: function (data) {
                    if(data.code==200){
                        $('#toLook').removeClass('hidden')
                        $('#cancel').text('确定').removeClass('hidden')
                        alert("success")
                        $('#modelColor').attr('style','background : #65CEA7')
                        $('#paperCreateTips').text('试卷：'+data.paperName+'创建成功！')
                        $('#tip2').click()
                    }
                    if(data.code == 500){
                        $('#modelColor').attr('style','background : #bb1f1f')
                        if(data.hasPaper == true){
                            $('#paperCreateTips').text('试卷：'+data.paperName+'创建失败！原因：该试卷已存在，不可重复创建。')
                            $('#tip2').click()
                            $('#toLook').removeClass('hidden')
                            $('#cancel').text('确定').removeClass('hidden')
                        }
                        else if (data.hasError!=null){
                            $('#toLook').addClass('hidden')
                            $('#cancel').text('确定').removeClass('hidden')
                            $('#paperCreateTips').text('试卷：'+data.paperName+'创建失败！原因:'+data.hasError)
                            $('#tip2').click()
                        }
                    }
                },

            })
        }
    }

    function toLook() {
        var pName = $('#successPaperName').val()
        window.location.replace('/admin/toPaperList'+'?searchName='+pName)
    }
    
    //日期格式化
    function dateFormat(date) {
        var arr = date.split(' ')
        var dd = arr[0]
        var monthArr = ['January','February','March','April','May','June','July','August','September','October','November','December']
        var month = 0
        var year = arr[2]
        var time = arr[4]+':00'
        for(var i =0; i<12; i++){
            if(arr[1]==monthArr[i]){
                month = month+i+1
            }
        }
        var Time =  year+'-'+month+'-'+dd+'T'+time
        return Time;
    }

    //增加题目数
    function incNumber(object){
        if (object.val()==null||object.val()==''){
            object.attr('value',0)
        }
        //获取数值，转int
        var num = parseInt(object.val())
        num = num+5
        //题数[0,100]范围
        if(num >= 0 && num <= 100){
            object.attr('value',num)
        }
    }
    //减少题目数
    function disNumber(object){
        if (object.val()==null||object.val()==''){
            object.attr('value',0)
        }
        //获取数值，转int
        var num = parseInt(object.val())
        num = num-5
        if(num >= 0){
            object.attr('value',num)
        }
    }
    //增加分数
    function incScore(object) {
        if (object.val()==null||object.val()==''){
            object.attr('value',0)
        }
        //获取数值，转int
        var score = parseInt(object.val())
        score = score+1
        //题数[0,20]范围
        if(score >= 0){
            object.attr('value',score)
        }
    }
    //减少分数
    function disScore(object) {
        if (object.val()==null||object.val()==''){
            object.attr('value',0)
        }
        //获取数值，转int
        var score = parseInt(object.val())
        score = score-1
        //题数[0,20]范围
        if(score >= 0){
            object.attr('value',score)
        }
    }

    //自定义创建的初始化
    $(document).ready( function() {
        var arr = document.getElementsByClassName('form-group s')
        for (var i =0; i < arr.length; i++){
            arr[i].setAttribute('class','hidden form-group s')
        }
        for (var i =0; i < 3; i++){
            arr[i].setAttribute('class','form-group s')
        }

        var arr2 = document.getElementsByClassName('form-group m')
        for (var i =0; i < arr2.length; i++){
            arr2[i].setAttribute('class','hidden form-group m')
        }
        for (var i =0; i < 3; i++){
            arr2[i].setAttribute('class','form-group m')
        }


    })

    //自定义创建增加题目数
    function incNumber1(object){
        //获取数值，转int
        var num = parseInt(object.value)
        num = num+5
        //题数[0,100]范围
        if(num >= 0 && num <= 100){
            object.value = num
        }
    }

    //自定义创建减少题目数
    function disNumber1(object){
        //获取数值，转int
        var num = parseInt(object.value)
        num = num-5
        //题数[0,100]范围
        if(num >= 0 && num <= 100){
            object.value = num
        }
    }

    //选择分类触发
    function questionPool1(va,te,_input,_button){
        $(_input).attr('value',va)
        _button.innerHTML = te
    }

    //单选增加选项：
    function addLine(){
        var arr = document.getElementsByClassName('hidden form-group s')
        if(arr.length==0){
            $('#cancel').text('确定').removeClass('hidden')
            $('#modelColor').attr('style','background : #65CEA7')
            $('#paperCreateTips').text('种类数达到上限！')
            $('#tip2').click()
        }
        if(arr.length>0){
            arr[0].setAttribute('class','form-group s')
        }
    }

    //多选增加选项：
    function addLine2(){
        var arr = document.getElementsByClassName('hidden form-group m')
        if(arr.length==0){
            $('#cancel').text('确定').removeClass('hidden')
            $('#modelColor').attr('style','background : #65CEA7')
            $('#paperCreateTips').text('种类数达到上限！')
            $('#tip2').click()
        }
        if(arr.length>0){
            arr[0].setAttribute('class','form-group m')
        }
    }


    //单选减少选项
    function  reduceLine(){
        var arr = document.getElementsByClassName('form-group s')
        var arr2 = document.getElementsByClassName('hidden form-group s')
        if(arr.length-arr2.length==1){
            $('#cancel').text('确定').removeClass('hidden')
            $('#modelColor').attr('style','background : #bb1f1f')
            $('#paperCreateTips').text('最少一个种类！')
            $('#tip2').click()
        }
            for(var i =arr.length-1 ;i > 0;i--){
                if(arr[i].getAttribute('class')=='form-group s'){
                    arr[i].setAttribute('class','hidden form-group s')
                    break;
                }
            }
    }

    //减少选项
    function  reduceLine2(){
        var arr = document.getElementsByClassName('form-group m')
        var arr2 = document.getElementsByClassName('hidden form-group m')
        if(arr.length-arr2.length==1){
            $('#cancel').text('确定').removeClass('hidden')
            $('#modelColor').attr('style','background : #bb1f1f')
            $('#paperCreateTips').text('最少一个种类！')
            $('#tip2').click()
        }
        for(var i =arr.length-1 ;i > 0;i--){
            if(arr[i].getAttribute('class')=='form-group m'){
                arr[i].setAttribute('class','hidden form-group m')
                break;
            }
        }
    }
    //自定义创建
    function diySubmit() {
        //获取自定义创建考试名、开始时间、结束时间
        var paperName = $('#paperName1').val()
        var startTime0 = $('#startTime1').val()
        var endTime0 = $('#endTime1').val()
        startTime1 = dateFormat(startTime0)
        endTime1 = dateFormat(endTime0)
        //获取所有的单选题的数量跟对应的类型
        var singleNumArray = {}
        var singlePoolArray = {}
        var singleInputNumber = document.getElementsByClassName('form-group s')
        for(var i =0;i<singleInputNumber.length;i++){
            var singNum = $("#singId"+parseInt(i+1)+"").val()
            var singPool = $("#singPool"+parseInt(i+1)+"").val()
            if(singNum!=0&&singPool!=0){
                singleNumArray[i] = $("#singId"+parseInt(i+1)+"").val()
                singlePoolArray[i] = $("#singPool"+parseInt(i+1)+"").val()
            }
        }
        //获取所有的多选题的数量跟对应的类型
        var moreNumArray = {}
        var morePoolArray = {}
        var moreInputNumber = document.getElementsByClassName('form-group m')
        for(var i =0;i<moreInputNumber.length;i++)
        {
            var moreNum = $("#moreId"+parseInt(i+1)+"").val()
            var morePool = $("#morePool"+parseInt(i+1)+"").val()
            if(moreNum!=0&&morePool!=0){
                moreNumArray[i] = $("#moreId"+parseInt(i+1)+"").val()
                morePoolArray[i] = $("#morePool"+parseInt(i+1)+"").val()
            }
        }
            $.ajax({
                //请求路径
                url: "/admin/createPaperDiy",
                //请求类型
                type: "POST",
                //data表示发送的数据
                data: JSON.stringify({
                    paperName:paperName,
                    startTime:startTime1,
                    endTime:endTime1,
                    singleNumArray:singleNumArray,
                    singlePoolArray:singlePoolArray,
                    moreNumArray:moreNumArray,
                    morePoolArray:morePoolArray
                }), //定义发送请求的数据格式为JSON字符串
                contentType: "application/json;charset=utf-8",
                //定义回调响应的数据格式为JSON字符串，该属性可以省略
                dataType: "json",
                //成功响应的结果
                success: function (data) {
                    if(data.code==200){
                        $('#toLook').removeClass('hidden')
                        $('#cancel').text('确定').removeClass('hidden')
                        alert("success")
                        $('#modelColor').attr('style','background : #65CEA7')
                        $('#paperCreateTips').text('试卷：'+data.paperName+'创建成功！')
                        $('#tip2').click()
                    }
                    if(data.code == 500){
                        $('#modelColor').attr('style','background : #bb1f1f')
                        if(data.hasPaper == true){
                            $('#paperCreateTips').text('试卷：'+data.paperName+'创建失败！原因：该试卷已存在，不可重复创建。')
                            $('#tip2').click()
                            $('#toLook').removeClass('hidden')
                            $('#cancel').text('确定').removeClass('hidden')
                        }
                        else if (data.hasError!=null){
                            $('#toLook').addClass('hidden')
                            $('#cancel').text('确定').removeClass('hidden')
                            $('#paperCreateTips').text('试卷：'+data.paperName+'创建失败！原因:'+data.hasError)
                            $('#tip2').click()
                        }
                    }
                },
            })
    }


    jQuery(document).ready(function() {
        EditableTable.init();
    });
    document.getElementById("paper-create").className="active";
    document.getElementById("menu3").className="menu-list nav-active";
</script>

</body>


</html>
<script>
    import Form_advanced_components from "./form_advanced_components.html";
    export default {
        components: {Form_advanced_components}
    }
</script>