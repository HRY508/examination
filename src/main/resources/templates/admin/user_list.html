<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>用户列表</title>
    <link th:href="@{/js/iCheck/skins/minimal/minimal.css}" rel="stylesheet">
    <link th:href="@{/js/iCheck/skins/minimal/minimal.css}" rel="stylesheet">
    <link th:href="@{/js/iCheck/skins/square/square.css}" rel="stylesheet">
    <link href="/js/iCheck/skins/square/red.css" rel="stylesheet">
    <link href="/js/iCheck/skins/square/blue.css" rel="stylesheet">
    <!--dashboard calendar-->
    <link href="/css/clndr.css" rel="stylesheet">
    <!--common-->
    <link href="/css/style.css" rel="stylesheet">
    <link href="/css/style-responsive.css" rel="stylesheet">
</head>

<body class="sticky-header">

<!--左侧开始-->
<div th:replace="~{/admin/commons/common :: commonleft}"></div>
<!--左侧结束-->

<!--主页面开始-->
<div class="main-content" >
    <!--头部开始-->
    <div th:replace="~{/admin/commons/common :: commonheader}"></div>
    <!--头部结束-->

    <!--body wrapper start-->
    <div class="wrapper">
        <div class="row">
            <div class="col-sm-12">
                <section class="panel">
                    <header class="panel-heading">
                        <form action="/admin/searchName" method="post">
                                用户名:<input type="text" value="" name="searchName">
                                <!--                            真实姓名：<input type="text" value="" name="realName" th:value="${realName}">-->
                                <!--                            学号:<input type="text" value="" name="uId" th:value="${uId}">-->
                                <button value="查询" class="btn btn-sm btn-default" ><i class="fa fa-plus"></i>查询</button>
                                <!--                            <a th:href="${/admin/searchSubmit}">查询</a>-->
                                <button class="btn btn-sm btn-default" onclick="DelSelect()">批量删除</button>
                        </form>

                    </header>

                    <div class="panel-body">
                        <div class="adv-table" style="height: 55em">
                            <div class="space15"></div>
                            <table class="display table table-hover" id="dynamic-table">
                                <thead>
                                <tr>
                                    <th>id</th>
                                    <th>用户名</th>
                                    <th>密码</th>
                                    <th>学号</th>
                                    <th>真实姓名</th>
                                    <th>性别</th>
                                    <th>职业</th>
                                    <th>权限</th>
                                    <th>创建时间</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr th:each="user : ${page.records}">
                                    <td class="center">  <input type="checkbox" name="id[]" value="" id="id[]" th:value="${user.id}"/></td>
                                    <td th:text="${user.userName}"></td>
                                    <td th:text="${user.password}"></td>
                                    <td th:text="${user.uId}"></td>
                                    <td th:text="${user.realName}"></td>
                                    <td th:text="${user.sex==1} ? '男' : '女'"></td>
                                    <td th:text="${user.profession}"></td>
                                    <td th:text="${user.perms}"></td>
                                    <td th:text="${#dates.format(user.createTime,'yyyy-MM-dd HH:mm:ss')}"></td>
                                    <td>
<!--                                        onclick="changeStatus()"-->
                                        <button th:text="${user.uStatus}==1?'启用':'禁用'" type="button" th:value="${user.id}" class="btn btn-sm btn-default"  name="statusButton"  id="statusButton" ><i class="fa fa-plus"></i>启用</button>
                                    </td>
                                    <td>
                                        <a th:href="@{/toEdit(id=${user.id})}">edit</a>
                                        <a  th:href="@{/admin/delete/{id}(id=${user.id})}"
                                           onclick="return del()" th:value="${user.id}" value="1">Delete
                                        </a>
                                    </td>
                                </tr>
                                </tbody>

                            </table>
                            <!--分页-->
                            <div th:replace="~{/admin/commons/page :: page}"></div>
                            <!--分页结束-->

                        </div>
                    </div>
                </section>

            </div>
        </div>
    </div>
    <!--body wrapper end-->

    <!--footer section start-->
    <footer>
        2022 &copy;<a href="https://www.pdsu.edu.cn/" target="_blank">平顶山学院软件应用双创实验室提供技术支持</a>
    </footer>
    <!--footer section end-->


</div>
<!--主页面结束-->



<!-- Placed js at the end of the document so the pages load faster -->
<script src="/js/jquery-1.10.2.min.js"></script>
<script src="/js/jquery-ui-1.9.2.custom.min.js"></script>
<script src="/js/jquery-migrate-1.2.1.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/modernizr.min.js"></script>
<script src="/js/jquery.nicescroll.js"></script>

<!--data table-->
<script type="text/javascript" src="/js/data-tables/jquery.dataTables.js"></script>
<script type="text/javascript" src="/js/data-tables/DT_bootstrap.js"></script>


<!--common scripts for all pages-->
<script src="/js/scripts.js"></script>
<!--script for editable table-->
<script src="/js/editable-table.js"></script>


<!--删除-->
<script type="text/javascript">
    // 单个删除
    function del() {
        if (confirm("您确定要删除吗？")) {
            return true;
        } else {
            return false;
        }
    }

    // 批量删除
    function DelSelect() {
        var Checkbox = false;
        $("input[name='id[]']").each(function() {
            if (this.checked == true) {
                Checkbox = true;
            }
        });
        if (Checkbox) {
            var t = confirm("您确认要删除选中的内容吗？");
            if (t == false) {
                return false;
            } else {
                var ids="";
                $("input[name='id[]']").each(function() {
                    if (this.checked == true) {
                        ids += this.value + ",";

                    }
                });
                window.location.replace("/admin/deleteCounts?ids="+ids);
            }
        } else {
            alert("请选择您要删除的内容!");
            return false;
        }
    }



<!-- END JAVASCRIPTS -->

    //获取按钮数组
    var len = document.getElementsByName("statusButton").length;
    //通过循环给每个按钮添加点击事件
    var temp = document.getElementsByName("statusButton")
    // alert(len)


    for(var i = 0; i < document.getElementsByName("statusButton").length ; i++){
        //获取每个按钮的值，index索引
        document.getElementsByName("statusButton")[i].onclick = (function() {
            var id = this.value
            var statusValue = this.innerHTML=='启用'?1:0
            this.innerHTML= this.innerHTML=='启用'?'禁用':'启用'
            $.ajax({
                //请求路径
                url: "/admin/statusChange",
                //请求类型
                type: "POST",
                //data表示发送的数据
                data: JSON.stringify({
                    uStatus: statusValue,
                    id: id
                }), //定义发送请求的数据格式为JSON字符串
                contentType: "application/json;charset=utf-8",
                //定义回调响应的数据格式为JSON字符串，该属性可以省略
                dataType: "json",
                //成功响应的结果
                success: function (data) {
                    if (data != null) {

                    }
                    else {
                        alert("error,状态修改失败");
                    }
                },
            })

        });
    }

    //状态改变函数
    // $('[id=要获取的id]').on('click',function() {
    //
    //     // //改变按钮状态
    //     // $('#statusButton').val("禁用");
    //     //获取按钮上的值
    //     var statusValue = $("#statusButton").html()=='启用'?1:0;
    //
    //     alert(id.item(1))

    // }
    //     });
    // }
    jQuery(document).ready(function() {
    EditableTable.init();
    });
    document.getElementById("user-list").className="active";
    document.getElementById("menu2").className="menu-list nav-active";
</script>

</body>


</html>
    <script>
        import Form_advanced_components from "./form_advanced_components.html";
        export default {
            components: {Form_advanced_components}
        }

    </script>